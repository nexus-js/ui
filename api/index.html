<!doctype html>
<html>
<head>
  <meta charset='utf-8' />
  <title>  | Documentation</title>
  <meta name='viewport' content='width=device-width,initial-scale=1'>
  <link href="https://fonts.googleapis.com/css?family=Muli:400,700" rel="stylesheet">
  <script src="jquery.js"></script>
  <link rel='stylesheet' href='../docs/source/prism/prism.css' />
  <script src="../docs/source/prism/prism.js"></script>
  <script src="js/moustache.min.js"></script>
  <script src="../dist/mt.js"></script>
  <script src="../example/js/Tone9.js"></script>
</head>
<body class='documentation'>

  <div id="sidebar" onmouseover="document.body.style.overflow='hidden';" onmouseout="document.body.style.overflow='auto';">

    <h2>Getting Started</h2>
    <a href="">Creating Interfaces</a><br />
    <a href="">Creating a Rack</a><br />

    <h2>Interfaces</h2>

    <h3>Core</h3>
    <a href="#Button">button</a><br />
    <a href="#Dial">dial</a><br />
    <a href="#Number">number</a><br />
    <a href="#Position">position</a><br />
    <a href="#Slider">slider</a><br />
    <a href="#Toggle">toggle</a><br />

    <h3>General</h3>
    <a href="#Envelope">envelope</a><br />
    <a href="#Multislider">multislider</a><br />
    <a href="#Piano">piano</a><br />
    <a href="#RadioButton">radiobutton</a><br />
  <!--  <a href="#Range">range</a><br /> -->
    <a href="#Sequencer">sequencer</a><br />
    <a href="#TextButton">textbutton</a><br />
  <!--  <a href="#Waveform">waveform</a><br /> -->


    <h3>Mobile</h3>
    <a href="#Tilt">tilt</a><br />

    <h3>Spatialization</h3>
    <a href="#Pan">pan</a><br />
    <a href="#Pan2D">pan2d</a><br />

    <h3>Visualization</h3>
    <a href="#Meter">meter</a><br />
    <a href="#Oscilloscope">oscilloscope</a><br />
    <a href="#Spectrogram">spectragram</a><br />


    <h2>Tuning</h2>
    <a href="#tune">tune</a><br />

    <h2>Timing</h2>
    <a href="#interval">interval</a><br />

  <!--  <h2>Models</h2>
    <a href="#counter">counter</a><br />
    <a href="#sequence">sequence</a><br />
    <a href="#drunk">drunk</a><br />
    <a href="#matrix">matrix</a><br /> -->

    <h2>Helpers</h2>
    <a href="#ri">ri (random integer)</a><br />
    <a href="#rf">rf (random float)</a><br />
    <a href="#clip">clip</a><br />
    <a href="#scale">scale</a><br />
    <a href="#mtof">mtof</a><br />
    <a href="#interp">interp</a><br />
    <a href="#pick">pick</a><br />
    <a href="#octave">octave</a><br />
    <a href="#distance">distance</a><br />
    <a href="#average">average</a><br />
    <a href="#coin">coin</a><br />
  </div>

  <div id="tutorial" class="tutorial">

    <div id="target"></div>

    <script id="template" type="x-tmpl-mustache">
    <h2>{{ name }}</h2>

    <div class="overview" >
    {{ description }}
      <br />
      <div id="demo">
        {{{ demo }}}
      </div>
    </div>


    {{#examples}}
      <div class="code-basic">
        {{title}}:
        <pre class="example"><code class="language-javascript">{{ description }}</code></pre>
      </div>
    {{/examples}}

    <div class="properties">

      {{#properties}}
        <div class="property">
          <div class="property-name">{{ name }}</div>
          <div class="property-type">{{{ type }}}</div>
          <div class="property-description">{{{ description }}}</div>
          {{ #example }}
            <pre class="example property-example"><code class="language-javascript">{{ code }}</code></pre>
            <div class="example-toggle">Example</div>
          {{ /example }}
        </div>
      {{/properties}}

    </div>

    <div class="methods">

      {{#methods}}
        <div class="method">
          <div class="method-name">{{ name }}(
            {{#parameters}}
              {{name}}{{^last}}, {{/last}}
            {{/parameters}}
          )</div>
          <div class="method-description">{{{ description }}}</div>
          {{ #example }}
            <pre class="example method-example"><code class="language-javascript">{{ code }}</code></pre>
            <div class="example-toggle">Example</div>
          {{ /example }}
        </div>
      {{/methods}}

    </div>


    <div class="output">
      <h4>Events</h4>
      {{ #outputs }}
        <h5>{{{ name }}}</h5>
        {{{ description }}} <br />
        {{ #example }}
          <pre class="example"><code class="language-javascript">{{ example }}</code></pre>
        {{ /example }}
      {{ /outputs }}
    </div>

    <div class="examples">

      {{#tutorials}}
        <div class="codepen">
          <h3>Example: {{name}}</h3>
          {{{codepen}}}
          {{description}}
        </div>
      {{/tutorials}}

    </div>

    </script>










    <script id="helper-template" type="x-tmpl-mustache">

      <h2>Helper Methods</h2>

      {{#helpers}}
        <div class="method" id="{{ name }}">
          <div class="method-name">{{ name }}(
            {{#parameters}}
              {{name}}{{^last}}, {{/last}}
            {{/parameters}}
          )</div>
          <div class="method-description">{{{ description }}}</div>
          <table style="padding: 5px">
            {{#parameters}}
              <tr>
                  <td style="padding:5px 10px">
                    <b>{{name}}:</b>
                  </td>
                  <td style="padding:5px 10px">
                    <i>{{type}}</i>
                  </td>
                  <td style="padding:5px 10px">
                    {{description}}
                  </td>
              </tr>
            {{/parameters}}
          </table>
          <pre class="example"><code class="language-javascript">{{ example }}</code></pre>
        </div>
      {{/helpers}}

      <br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />

    </script>

  </div>



<!--

MT.TUNE

-->

  <div id="tune" class="custom-tutorial" style="display:none">
    <h2>mt.tune: Pitches and Scales</h2>

    <p>
      This toolkit provides rudimentary methods for managing musical scales. The approach emphasizes algorithmic composition by turning musical pitches into numbers -- using scale degrees numbers and octave numbers instead of note names like C, D, and E. Here is an example:
    </p>

     <pre><code class="language-javascript">
// Create a major chord drone, assuming synth1, synth2, and synth3 exist

// mt.note(0) returns the frequency of the 1st note of the scale
synth1.frequency.value = mt.note(0);

// mt.note(2) returns the frequency of the 3rd note of the scale
synth2.frequency.value = mt.note(2);

// mt.note(4) returns the frequency of the 5th note of the scale
synth3.frequency.value = mt.note(4);
     </code></pre>

<!--     <pre><code class="language-javascript">
// Every 100ms, play a random note from a random octave in the major scale
mt.interval(100,function() {
 var scaleDegree = mt.ri( 0, mt.tune.scale.length );
 var octave = mt.ri( -3 , 3 );
 synth1.frequency.value = mt.tune.note( scaleDegree, octave ); // returns the root
})
     </code></pre> -->

Another example:
    <pre><code class="language-javascript">
// Play 5 octaves of the major scale

var scaleDegree = mt.counter( 0, mt.tune.scale.length*5 );

mt.interval(100,function() {
  synth1.frequency.value = mt.tune.note( scaleDegree.next() );
})
    </code></pre>




    <!-- section -->

    <h3>Turning Scale Degrees to Frequency Numbers with mt.note()</h3>
     <p>
       <span class="codesnipper">mt.note()</span> provides a method to turn scale degrees into frequency numbers. An optional second octave parameter lets you shift the frequency up or down by an octave.
     </p>

     <pre>
       <code class="language-javascript">
synth.frequency.value = mt.note(0) // returns the root
       </code>
     </pre>


     <!-- section -->

     <h3>Getting Ratios or MIDI instead of Frequencies</h3>
     <p>
       For other ways of retrieving pitch data, ... <b>mt.tune.frequency</b>, <b>mt.tune.ratio</b>, and <b>mt.tune.midi</b>
     </p>



    <!-- section -->

    <h3>Changing the Scale</h3>
    <p>
      By default, the scale is an equal-tempered major scale.
    </p>
    <p>
      We do not provide any other built-in scales. However, we provide two ways for you to create your own scale.
    </p>

    <h4>Describing an Equal-Tempered Scale</h4>
    <pre><code class="language-javascript">
// Create a minor scale
mt.tune.createScale(0,2,3,5,7,8,10);
    </code></pre>


    <h4>Describing a Just Intonation Scale</h4>
    <pre><code class="language-javascript">
// Create a major scale in just intonation
mt.tune.createJIScale( 1/1, 9/8, 5/4, 4/3, 3/2, 8/5, 5/3, 15/8 );
    </code></pre>


    <!-- section -->

    <h3>Changing the root </h3>
    <p>
      By default, the root of the scale is Middle C. Therefore, <b>mt.note(0)</b> returns the frequency for Middle C.
    </p>

    <p>
      You can set the root using <b>mt.tune.root</b>, which is a frequency value.
    </p>

    <pre><code class="language-javascript">
// Set the root to C 3 octaves below Middle C.
mt.tune.root = mt.tune.note(0,-3);
    </code></pre>


    <p>
      The root can also be set using traditional musical values like "C3" or "A1". This is the only place in this toolkit where this type of music notation is used.
    </p>

    <pre><code class="language-javascript">
// Set the root to low A.
mt.tune.root = "A1";
    </code></pre>


    <p>
      If working in just intonation, you can set mt.tune.root direction to a frequency value.
    </p>

    <pre><code class="language-javascript">
// Set the root of your JI scale to 120hz.
mt.tune.root = 120;
    </code></pre>

  </div>








  <!--

  MT.MATRIX

  -->

    <div id="Matrix" class="custom-tutorial" style="display:none">
      <h2>Matrix Model</h2>

      <p>
        The Matrix Model lets you read, write, and manipulate a two-dimensional array of data (such as the data that is visualized by a <a href="#Sequencer">sequencer</a>).
      </p>
<br />
Creating a Matrix Model from scratch...
       <pre><code class="language-javascript">
  matrix = new mt.Matrix(10,5);
  matrix.toggle.cell(1,1);
  matrix.rotate.row(1);

  console.log( matrix.pattern );
  console.log( matrix.length );

  // matrix.format() returns a text visualization with 1s and 0s.
  console.log( matrix.format() );
       </code></pre>

  <!--     <pre><code class="language-javascript">
  // Every 100ms, play a random note from a random octave in the major scale
  mt.interval(100,function() {
   var scaleDegree = mt.ri( 0, mt.tune.scale.length );
   var octave = mt.ri( -3 , 3 );
   synth1.frequency.value = mt.tune.note( scaleDegree, octave ); // returns the root
  })
       </code></pre> -->

  Working with a sequencer's Matrix Model.
      <pre><code class="language-javascript">
  var sequencer = new mt.Sequencer("#target",5,10);
  sequencer.matrix.toggle.row(2);
  sequencer.matrix.set.row(1, [0,1,0,1,0,1,0,1,0,1])
      </code></pre>




      <!-- section -->

      <h3>Understanding Matrix.pattern</h3>
       <p>
         <span class="codesnipper">mt.note()</span> provides a method to turn scale degrees into frequency numbers. An optional second octave parameter lets you shift the frequency up or down by an octave.
       </p>

       <pre>
         <code class="language-javascript">
  synth.frequency.value = mt.note(0) // returns the root
         </code>
       </pre>


       <!-- section -->

       <h3>Control Methods</h3>
       <p>
         For other ways of retrieving pitch data, ... <b>mt.tune.frequency</b>, <b>mt.tune.ratio</b>, and <b>mt.tune.midi</b>
       </p>

      <h4>.set</h4>
      <pre><code class="language-javascript">
  // Create a minor scale
  mt.tune.createScale(0,2,3,5,7,8,10);
      </code></pre>


      <h4>.toggle</h4>
      <pre><code class="language-javascript">
  // Create a major scale in just intonation
  mt.tune.createJIScale( 1/1, 9/8, 5/4, 4/3, 3/2, 8/5, 5/3, 15/8 );
      </code></pre>

    </div>








</body>

<script>

  var Unformatted = {}
  var API = {}
  var Helpers = []
  mt.context = Tone.context;


  $.getJSON('api.json', function(data) {
    data.forEach(function(entry) {
      Unformatted[entry.name] = entry
    })
    console.log(Unformatted)


    // Parse Helper doc into Helpers object
    for (var key in Unformatted) {
      if ( LoadLinks.Helper.indexOf(key) >=0 ) {
        var unformatted = Unformatted[key]
        console.log(unformatted);
        var entry = {
          name: unformatted.name,
          parameters: unformatted.params,
          description: unformatted.description.children[0].children[0].value,
          returns: {
            type: unformatted.returns[0].type,
            description: unformatted.returns[0].description.children[0].children[0].value
          },
          example: unformatted.examples[0].description,
        }
        var params = []
        if (entry.parameters) {
          entry.parameters.forEach(function(param) {
            params.push({
              name: param.name,
              type: param.type.name,
              description: param.description.children[0].children[0].value
            })
          })
          entry.parameters = params
          entry.parameters[ entry.parameters.length - 1 ].last = true;
        }
        Helpers.push(entry);
      }
    }


    // Parse interface documentation into API object
    for (var key in Unformatted) {
      var unformatted = Unformatted[key]
      var entry = {
        name: unformatted.name,
        examples: unformatted.examples,
        outputs: []
      }
      var exampleTypes = ['Basic', 'With Options']
      if (entry.examples) {
        for (var i=0; i<entry.examples.length;i++) {
          entry.examples[i].title = exampleTypes[i];
        }
      }
      for (var i=0; i<unformatted.tags.length;i++) {
        if (unformatted.tags[i].title==="output") {
          var name = unformatted.tags[i].description.split('\n').slice(0,1)[0]
          var desc = unformatted.tags[i].description.split('\n').slice(1).join("\n")
          entry.outputs.push({
            name: name,
            description: desc,
            example: ''
          })
        } else if (unformatted.tags[i].title==="outputexample") {
          if (entry.outputs.length-1>=0) {
            entry.outputs[entry.outputs.length-1].example = unformatted.tags[i].description
          }
        }
        entry[unformatted.tags[i].title] = unformatted.tags[i].description
      }


      // collect members
      var members = unformatted.members.instance

      //get inherited members
      if (unformatted.augments) {
        for (var i=0; i<unformatted.augments.length;i++) {
          let name = unformatted.augments[i].name
          if (name != "EventEmitter") {
            members = members.concat(Unformatted[name].members.instance)
            if (Unformatted[name].augments) {
              unformatted.augments.push( Unformatted[name].augments[0] )
            }
          }
        }
      }

      //sort members
      entry.properties = []
      entry.methods = []
      for (var i=0; i<members.length;i++) {
        if (members[i].kind=="function") {
          var method = {
            name: members[i].name,
            parameters: [],
            description: members[i].description.children[0].children[0].value,
            returns: false,
            example: false,
          }
          for (var j=0; j<members[i].tags.length; j++) {
            var tag = members[i].tags[j]
            switch (tag.title) {
              case 'type':
                method.type = tag.type.name
                break;
              case 'example':
                method.example = {
                  code: tag.description
                }
                break;
            }
          }
          /*  parameters */
          if (members[i].params) {
            for (var j=0; j<members[i].params.length; j++) {
              method.parameters.push({
                name: members[i].params[j].name
              //  type: members[i].params[j].name,
              })
            }
            method.parameters[ method.parameters.length - 1 ].last = true;
          }

          entry.methods.push(method)
        } else {
          var property = {
            name: members[i].name,
            description: members[i].description.children[0].children[0].value,
            type: '',
            example: false
          }
          for (var j=0; j<members[i].tags.length; j++) {
            var tag = members[i].tags[j]
            switch (tag.title) {
              case 'type':
                property.type = tag.type.name
                if (TypeLinks.indexOf(property.type)>=0) {
                  property.type = '<a href="#'+property.type+'">'+property.type+'</a>';
                }
                break;
              case 'example':
                property.example = {
                  code: tag.description
                }
                break;
            }
          }
          entry.properties.push(property);
        }
      }

      /* alphabetize members */
    //  for (var i=0; i<entry.properties.length;i++) {
        entry.properties.sort(function(a, b) {
            return a.name.localeCompare(b.name);
        });
            entry.methods.sort(function(a, b) {
                return a.name.localeCompare(b.name);
            });
    //  }



      entry.tutorials = []
      for (var i=0; i<unformatted.tags.length;i++) {
        if (unformatted.tags[i].title == 'tutorial') {
          var contents = unformatted.tags[i].description
          var name = contents.split("\n")[0]
          var codepen = contents.split("\n")[1]
          var description = contents.split("\n")[2]
          entry.tutorials.push( {
            description: description,
            name: name,
            codepen: '<p data-height="265" data-theme-id="0" data-slug-hash="'+codepen+'" data-default-tab="js,result" data-user="taylorbf" data-embed-version="2" data-pen-title="'+codepen+'" class="codepen">See the Pen <a href="http://codepen.io/taylorbf/pen/'+codepen+'/">'+codepen+'</a> by Ben Taylor (<a href="http://codepen.io/taylorbf">@taylorbf</a>) on <a href="http://codepen.io">CodePen</a>.</p><scr'+'ipt async src="https://production-assets.codepen.io/assets/embed/ei.js"></scr'+'ipt>'
          })
        }
      }



      API[key] = entry
    }


    //load hash
    if(window.location.hash) {
      var hash = window.location.hash.substring(1); //Puts hash in variable, and removes the # character
      load(hash);
    }

    window.addEventListener("hashchange", function() {
      var hash = window.location.hash.substring(1); //Puts hash in variable, and removes the # character
      load(hash);
      window.scrollTo(0,0);
    }, false);


  });

  var instrument = false
  var player = player = new Tone.Player("../example/media/D-sharp.mp3");

  function doc(name) {
  //  if (window.location.hash.substring(1)!=name) {
  //    window.location.hash = name;
  //  }
    var entry = API[name];
    var template = $('#template').html();
    Mustache.parse(template);   // optional, speeds up future uses
    var rendered = Mustache.render(template, entry);
    $('#target').html(rendered);
    Prism.highlightAll();

    if (instrument) {
      if (instrument.ui[""])
        try {
          instrument.ui[""].destroy();
        } catch(e) {
          console.log(e);
        }
    }
    instrument = mt.rack("demo");

    $(".example-toggle").click(function() {
      $(this).parent().find(".example").toggle();
    })

    if (name=="Waveform") {
      player.load("../example/media/D-sharp.mp3",function() {
        instrument.ui[""].load(player.buffer._buffer)
      })
    } else if (["Meter","Oscilloscope","Spectrogram"].indexOf(name)>-1) {
      player.load("../example/media/D-sharp.mp3",function() {
        player.loopStart = 0;
        player.loopEnd = 3;
        player.loop = true;
        instrument.ui[""].connect(player,2);
        player.start();
      })
    }
  }


  function tut(name) {
  //  if (window.location.hash.substring(1)!=name) {
  //    window.location.hash = name;
  //  }
    $('#target').empty();
    if ($("#"+name).length>0) {
      $("#"+name).clone().appendTo('#target').show()
      Prism.highlightAll();



      if (instrument) {
        if (instrument.ui[""])
          try {
            instrument.ui[""].destroy();
          } catch(e) {
            console.log(e);
          }
      }

      instrument = mt.rack("target");
    }
  }

  function helper(name) {

  //  if (window.location.hash.substring(1)!=name) {
  //    window.location.hash = name;
  //  }


    if (instrument) {
      if (instrument.ui[""])
        try {
          instrument.ui[""].destroy();
        } catch(e) {
          console.log(e);
        }
    }

    var entry = {"helpers": Helpers}
    var template = $('#helper-template').html();
    Mustache.parse(template);   // optional, speeds up future uses
    var rendered = Mustache.render(template, entry);

    $('#target').html(rendered);
    Prism.highlightAll();

    $('html, body').animate({
        scrollTop: $("#"+name).offset().top - 20
    }, 500);


  /*  $("#"+name).css("background-color","#0af");
    $("#"+name).css("transition","background-color 1s ease");
    $("#"+name).css("background-color","#fff"); */



  }

  var TypeLinks = [
    "Matrix",
    "Counter"
  ]

  var LoadLinks = {
    "Doc": [
      'Button', 'Dial', 'Number', 'Position', 'Slider', 'Toggle',
      'Envelope', 'Sequencer', 'Multislider', 'Piano', 'RadioButton',
      'Range', 'TextButton', 'Waveform', 'Tilt', 'Pan', 'Pan2D', 'Meter',
      'Oscilloscope', 'Spectrogram'
    ],
    "Tut": [
      'tune', 'Interval', 'Counter', 'Sequence', 'Drunk', 'Matrix', '',  '', '',
    ],
    "Helper": [
      'ri', 'rf', 'clip', 'scale', 'mtof', 'interp', 'pick', 'octave', 'distance', 'average', 'coin'
    ]
  }

  function load(name) {
    if (LoadLinks.Doc.indexOf(name)>=0) {
      doc(name);
    } else if (LoadLinks.Tut.indexOf(name)>=0) {
      tut(name);
    } else if (LoadLinks.Helper.indexOf(name)>=0) {
      helper(name);
    }
  }
</script>
<style>

  body {
    font-family: 'Muli', helvetica;
    padding:0;
    margin:0;
    width:100%;
    user-select:#000 !important;
  }

  #sidebar {
    position:fixed;
    height:100%;
    overflow:auto;
    width:225px;
    padding:10px 20px 20px;
    box-sizing:border-box;
  }
  #tutorial {
    width: calc(100% - 225px);
    float:left;
  }

  h1, h2, h3 {
    line-height: 1em;
    padding:0;
    font-weight:700;
  }
  h1 {
    margin:20px 0px 5px;
  }
  h2 {
    margin:20px 0px 5px;
    font-size:20px;
  }
  h3 {
    margin:10px 0px 5px;
    font-size:16px;
  }
  #sidebar a {
    line-height:1.3em;
    color:#555;
    text-decoration:none;
  }
  #sidebar a:hover {
    text-decoration:underline;
  }
  #tutorial a {
    line-height:1.3em;
    color:#09d;
    text-decoration:none;
  }
  #tutorial a:hover {
    text-decoration:underline;
  }



  /* Doc Tutorial Entry */
  .tutorial {
  	margin-left: 225px;
  	width: calc(100% - 200px);
  	padding:0px 20px;
  	height:100%;
  	overflow:auto;
  	box-sizing:border-box;
  	font-weight: 400;
  	font-size:15px;
  }

  .tutorial .overview {
  	padding-bottom:20px;
  }

  .tutorial h2 {
  	font-size:35px;
  }
  .tutorial h3 {
  	font-size:30px;
  }
  .tutorial h4 {
  	font-size:30px;
    margin:0px;
  }
  .tutorial h5 {
  	font-size:20px;
    margin:20px 0px 10px;
  }

  .tutorial .output, .tutorial .properties, .tutorial .codepen {
  	border-top: solid 0px #ccc;
  	margin-top:30px;
  	padding:30px 0px 0px;
  }

  .tutorial .properties {
    padding:0px 0px 0px;
  }

  .tutorial .property-name, .tutorial .method-name {
    font-weight: 700;
    padding: 0px 20px 0px 0px;
    font-size: 17px;
    display: inline-block;

  }
  .tutorial .property-type, .tutorial .method-type {
  	display:inline-block;
  	font-style:italic;
  	color:#aaa;
  }
  .tutorial .property-description, .tutorial .method-description {
  	padding:5px 0px;
  	font-size:15px;
  	color:#333;
  	letter-spacing: 0.2px;
  }
  .tutorial .property-example, .tutorial .method-example {
  	padding:20px;
    display:none;
  }

  .tutorial .property, .tutorial .method {
    border: solid 1px #555;
    padding: 10px 20px;
    border-left-width: 1px;
    margin: 20px 0px;
    border-bottom: none;
    border-right: none;
    position:relative;
  }
  .tutorial .example-toggle {
    position:absolute;
    top:0px;
    right:0px;
    border: solid 1px #555;
    color:#333;
    padding:3px 6px;
    font-size:11px;
    border-top:none;
    cursor:pointer;
  }
  .tutorial .example-toggle:hover {
    background-color:#eee;
  }


  .custom-tutorial pre {
    padding:0px 25px;
  }

  .custom-tutorial h3 {
    margin-top:30px;
  }

  .mt-ui {
    display:inline-block;
  }

</style>
</html>
